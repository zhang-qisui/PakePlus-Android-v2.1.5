import{y as F,v as n,z as I,A as R,x as U,al as V,h as $,j as D,o as c,c as _,w as t,d as o,k as i,t as g,n as P,f as Q,r as q,F as z,e as h,I as C,am as J,i as M,p as j,E as G}from"./index.1767597253495.js";import{_ as H}from"./u-loadmore.2e529468.js";import{_ as K}from"./live.718e5af7.js";import{A as W}from"./index.80508513.js";import{N as X}from"./index.ce942f0e.js";import{E as Y}from"./index.48c17fa0.js";import{e as Z,f as ee,h as ae}from"./home.c6cabe6a.js";import{_ as te}from"./_plugin-vue_export-helper.c27b6911.js";import"./u-loading-icon.673d6857.js";import"./u-search.8580cc22.js";import"./u-icon.33222906.js";const le=F({__name:"index",setup(se){const l=n({}),v=n([]),w=n(1),L=n(10),k=n(0),r=n("loadmore"),A=n("努力加载中 ！"),T=n("点击载更多"),B=n("没有更多数据了"),p=n(!1),N=async()=>{var u={id:l.value.id,page:w.value,per_page:L.value},a;if(l.value.title=="专题"?a=await Z(u):l.value.title=="科室"?a=await ee(u):l.value.title=="专家"&&(a=await ae(u)),a.returnCode==200){var e=[...v.value,...a.data.list.data];const m=new Map,f=e.filter(d=>m.has(d.id)?!1:(m.set(d.id,!0),!0));v.value=f,k.value=a.data.list.total,w.value=a.data.list.current_page,L.value=a.data.list.per_page,p.value=a.data.followStatus,v.value.length>=k.value?r.value="nomore":r.value="loadmore"}},O=async()=>{if(r.value=="nomore"){console.log("没有更多数据了"),C({title:"已经没有更多数据了",duration:2e3,icon:"none"});return}else r.value=="loadmore"?(r.value="loading",w.value=Number(w.value)+1,await N(),v.value.length==k.value?r.value="nomore":r.value="loadmore"):r.value=="loading"&&C({title:"当前正在加载中",duration:2e3,icon:"none"})},E=async u=>{var d,x;if(((d=l.value)==null?void 0:d.title)=="专家")var a=3;else if(((x=l.value)==null?void 0:x.title)=="专题")var a=1;else var a=2;if(p.value==!0)var e=2;else var e=1;var m={id:u,method:a,action:e};const f=await J(m);console.log("关注/取消关注",f),f.returnCode==200&&(e==1?p.value=!0:p.value=!1,C({title:f.msg,duration:2e3,icon:"none"}))},S=n();return I(()=>{S.value&&S.value.handleScroll()}),R(async u=>{var a,e;console.log("options",JSON.stringify(u)),l.value=u,l.value.title&&(l.value.title=decodeURIComponent(l.value.title)),(a=l.value)!=null&&a.info&&(l.value.info=JSON.parse(decodeURIComponent((e=l.value)==null?void 0:e.info)))}),U(async()=>{await V(),N()}),(u,a)=>{const e=M,m=j,f=$(D("up-loadmore"),H);return c(),_(W,null,{default:t(()=>[o(X,{style:{width:"95%"},ref_key:"navQueryRef",ref:S},null,512),o(e,{class:"debutBox"},{default:t(()=>{var d,x;return[o(e,{class:"toptitle"},{default:t(()=>[o(e,{class:"topTitle-left"},{default:t(()=>{var s,y;return[i(g((y=(s=l.value)==null?void 0:s.info)==null?void 0:y.name),1)]}),_:1}),o(e,{class:P(p.value==!0?"followBtn-select":"followBtn"),onClick:a[0]||(a[0]=s=>{var y,b;return E((b=(y=l.value)==null?void 0:y.info)==null?void 0:b.id)})},{default:t(()=>[i(g(p.value==!0?"已关注":"关注"),1)]),_:1},8,["class"])]),_:1}),o(e,{class:"title"},{default:t(()=>[o(e,{class:"text-left"},{default:t(()=>[o(m,{src:K,style:{width:"40rpx",height:"40rpx","margin-right":"5rpx"},alt:"",mode:"widthFix",class:"_u_alt"}),i(" 直播视频 ")]),_:1})]),_:1}),(c(!0),Q(z,null,q(v.value,s=>(c(),_(e,{class:"content",key:s.id},{default:t(()=>[o(e,{class:"left-img"},{default:t(()=>[G("img",{src:s.pic,style:{width:"100%",height:"100%"},width:"100%",hieght:"100%",alt:"",class:"_u_alt"},null,8,["src"]),s.status=="未开始"?(c(),_(e,{key:0,class:"tab-noStart"},{default:t(()=>[i(" 未开始 ")]),_:1})):h("",!0),s.status=="直播中"?(c(),_(e,{key:1,class:"tab-start"},{default:t(()=>[i(" 直播中 ")]),_:1})):h("",!0),s.status=="回放中"?(c(),_(e,{key:2,class:"tab-finish"},{default:t(()=>[i(" 回放中 ")]),_:1})):h("",!0)]),_:2},1024),o(e,{class:"right-info"},{default:t(()=>[o(e,{class:"title"},{default:t(()=>[i(g(s.title),1)]),_:2},1024),o(e,{class:"tips"},{default:t(()=>[i(g(s.OwnerAlias),1)]),_:2},1024),o(e,{class:"tips-date"},{default:t(()=>[o(e,{class:"date"},{default:t(()=>[i(g(s.StartTime),1)]),_:2},1024),o(e,{class:"number"},{default:t(()=>[i(g(s.Online?s.Online:0)+"观看 ",1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),((d=v.value)==null?void 0:d.length)!=0?(c(),_(f,{key:0,dashed:"",line:"",status:r.value,"loading-text":A.value,"loadmore-text":T.value,"nomore-text":B.value,onClick:a[1]||(a[1]=s=>O()),class:"_u_dashed _u_line"},null,8,["status","loading-text","loadmore-text","nomore-text"])):h("",!0),((x=v.value)==null?void 0:x.length)==0?(c(),_(Y,{key:1})):h("",!0)]}),_:1})]),_:1})}}});const me=te(le,[["__scopeId","data-v-83ea1b7a"]]);export{me as default};
